import{ref as p,reactive as $,createApp as v,resolveComponent as P,openBlock as r,createElementBlock as l,normalizeClass as b,normalizeStyle as k,createBlock as h,withModifiers as I,createCommentVNode as R,defineComponent as E,defineAsyncComponent as L,Fragment as _,createElementVNode as V,renderList as C,unref as j,resolveDynamicComponent as D}from"/view-ui/libs/vue.js";import d,{events as w,baseURL as M,importApp as N,getAppOptions as z,extendsOptions as q,importComponent as F}from"/view-ui/libs/view.js";import{apps as m}from"/view-ui/libs/state.js";import A from"/view-ui/libs/components.js";import{close as S}from"/view-ui/libs/navigator.js";import T from"/view-ui/libs/router.js";import{_ as B}from"../export-helper.js";w.on("opening",(o,t,i)=>{console.log("opening")});w.on("closing",o=>{console.log("closing")});let O=1;const U={props:{options:Object},setup({options:o}){const{app:t,paths:i}=o,{split:e=!1}=t;return{app:t,zIndex:p(O++),down:p(!1),fixed:p(!1),flex:p(!1),style:$({}),qrcode:p(""),split:p(e),disabledBack:p(!0)}},computed:{href(){const{url:o}=this.options;return`${M}/#${o}`}},methods:{close:S,async create(o){const t=await N(o),{style:i}=t;i&&Object.assign(this.style,i);const e=this.$refs.mount;if(t.install)t.install(e,{app:this});else{const{pages:s}=t;if(s){const n=v({components:{Main:t}});n.use(A),this.router=new T({app:n});const c=n.mount(e);this.$subRoot=c,this.flex=!0,this.router.$root=c,this.disabledBack=!1}else{const n=v({...t});n.use(A),n.mount(e)}}},back(){this.router&&this.router.back()},stickyTop(){this.zIndex=O++}},mounted(){const{src:o}=this.app;o&&this.create(o)}},W=["src"];function G(o,t,i,e,s,n){const c=P("container");return r(),l("section",{class:b(["app",{controlLayer:o.controlbar}]),style:k({zIndex:e.zIndex})},[e.app.src?(r(),h(c,{key:0,class:b({flex:e.flex}),level:"100",ref:"mount",style:k(e.style),onPointerdown:t[0]||(t[0]=I(()=>{},["stop"])),onPointerup:t[1]||(t[1]=I(()=>{},["stop"]))},null,8,["class","style"])):e.app.iframe?(r(),l("iframe",{key:1,src:e.app.iframe,frameborder:"0"},null,8,W)):R("",!0)],6)}const H=B(U,[["render",G],["__scopeId","data-v-f3d72b8e"]]),J={class:"single apps"},K=E({__name:"index",setup(o){const t=$([]);return d.initDataPromise.then(i=>{const e=z(d.pathname);d.initOptions=q(e);const{mask:s,main:n,app:c,apps:y,...x}=e;if(c)m.push(e);else if(y){const{urls:f}=y;if(f){const[a]=f;if(a){const u=z(a);m.push(u)}}}else n&&m.push(e);s&&console.log(e);for(const f in x){const a=x[f];if(a){const{single:u,src:g}=a;u===!0&&g&&t.push(L(()=>F(g)))}}}),(i,e)=>(r(),l(_,null,[V("div",J,[(r(!0),l(_,null,C(j(m),s=>(r(),h(H,{key:s.url,options:s},null,8,["options"]))),128))]),(r(!0),l(_,null,C(t,s=>(r(),h(D(s)))),256))],64))}});const se=B(K,[["__scopeId","data-v-d94aef70"]]);export{se as default};
