import{ref as p,reactive as $,createApp as v,resolveComponent as R,openBlock as i,createElementBlock as a,normalizeClass as b,normalizeStyle as k,createBlock as h,withModifiers as I,createCommentVNode as E,defineComponent as L,defineAsyncComponent as V,Fragment as _,createElementVNode as j,renderList as C,unref as D,resolveDynamicComponent as M}from"/demo/libs/vue.js";import d,{events as w,baseURL as N,importAsyncComponent as B,getAppOptions as z,extendsOptions as q}from"/demo/libs/view.js";import{apps as u}from"/demo/libs/state.js";import A from"/demo/libs/components.js";import{close as F}from"/demo/libs/navigator.js";import S from"/demo/libs/router.js";import{_ as P}from"../export-helper.js";w.on("opening",(o,t,r)=>{console.log("opening")});w.on("closing",o=>{console.log("closing")});let O=1;const T={props:{options:Object},setup({options:o}){const{app:t,paths:r}=o,{split:e=!1}=t;return{app:t,zIndex:p(O++),down:p(!1),fixed:p(!1),flex:p(!1),style:$({}),qrcode:p(""),split:p(e),disabledBack:p(!0)}},computed:{href(){const{url:o}=this.options;return`${N}/#${o}`}},methods:{close:F,async create(o){const t=await B(o),{style:r}=t;r&&(console.log(r),Object.assign(this.style,r),console.log(this.style));const e=this.$refs.mount;if(t.install)t.install(e,{app:this});else{const{pages:s}=t;if(s){const n=v({components:{Main:t}});n.use(A),this.router=new S({app:n});const l=n.mount(e);this.$subRoot=l,this.flex=!0,this.router.$root=l,this.disabledBack=!1}else{const n=v({...t});n.use(A),n.mount(e)}}},back(){this.router&&this.router.back()},stickyTop(){this.zIndex=O++}},mounted(){const{src:o}=this.app;o&&this.create(o)}},U=["src"];function W(o,t,r,e,s,n){const l=R("container");return i(),a("section",{class:b(["app",{controlLayer:o.controlbar}]),style:k({zIndex:e.zIndex})},[e.app.src?(i(),h(l,{key:0,class:b({flex:e.flex}),level:"100",ref:"mount",style:k(e.style),onPointerdown:t[0]||(t[0]=I(()=>{},["stop"])),onPointerup:t[1]||(t[1]=I(()=>{},["stop"]))},null,8,["class","style"])):e.app.iframe?(i(),a("iframe",{key:1,src:e.app.iframe,frameborder:"0"},null,8,U)):E("",!0)],6)}const G=P(T,[["render",W],["__scopeId","data-v-1b7ad260"]]),H={class:"single apps"},J=L({__name:"index",setup(o){const t=$([]);return d.initDataPromise.then(r=>{const e=z(d.pathname);d.initOptions=q(e);const{mask:s,main:n,app:l,apps:y,...x}=e;if(l)u.push(e);else if(y){const{urls:f}=y;if(f){const[c]=f;if(c){const m=z(c);u.push(m)}}}else n&&u.push(e);s&&console.log(e);for(const f in x){const c=x[f];if(c){const{single:m,src:g}=c;m===!0&&g&&t.push(V(()=>B(g)))}}}),(r,e)=>(i(),a(_,null,[j("div",H,[(i(!0),a(_,null,C(D(u),s=>(i(),h(G,{key:s.url,options:s},null,8,["options"]))),128))]),(i(!0),a(_,null,C(t,s=>(i(),h(M(s)))),256))],64))}});const oe=P(J,[["__scopeId","data-v-f3509f21"]]);export{oe as default};
